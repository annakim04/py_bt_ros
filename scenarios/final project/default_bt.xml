<?xml version="1.0" encoding="UTF-8"?>

<root main_tree_to_execute="MainTree">

  <BehaviorTree ID="MainTree">

    <ReactiveSequence>

      <ReactiveFallback>

        <Sequence>

          <ParcelAvailable/>

          <ReactiveFallback>

            <ReactiveSequence>
              <OtherRobotReceiving/>
              <MoveToPickupWaiting/>
            </ReactiveSequence>

            <MoveToPickup/>

          </ReactiveFallback>


          <RetryUntilSuccessful num_attempts="60">
            <ReceiveParcel/>
          </RetryUntilSuccessful>


          <Timeout duration="10.0">
            <WaitForQRPose/>
          </Timeout>

          <ReactiveFallback>
            <ReactiveSequence>
              <IsButtonPressed/>
              <MoveToDelivery/>
            </ReactiveSequence>
             
            <SpinInPlace/>
          </ReactiveFallback>

          <ReactiveFallback>
            <ReactiveSequence>
              <OtherRobotDropping/>
              <MoveToWaitingDrop/>
            </ReactiveSequence>
            <MoveToDelivery/>

          </ReactiveFallback>
          <RetryUntilSuccessful num_attempts="999999">
            <DropoffParcel/>
          </RetryUntilSuccessful>

        </Sequence>
        <MoveToCharge/>

      </ReactiveFallback>

    </ReactiveSequence>

  </BehaviorTree>

</root>
